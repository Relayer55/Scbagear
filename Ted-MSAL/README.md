# Description of Ted-MSAL folder

## Installation

I took care of the installation by downloading recent versions of Microsoft.Identity.Client.dll and Microsoft.IdentityModel.Abstractions.dll and embedding them in the source code folder. I got them from the official Nuget repository. If ScubaGear were to use these assemblies we would need to write code in our setup routines to get the right version of the dll file that matches the system ScubaGear is running on.

## SharepointAPIWithCertificate.ps1

This script calls the .NET MSAL AcquireTokenForClient method to authenticate and acquire a token using client certificate authentication. You need to have an Entra Id registered application like the Scuba Functional Test Orchestrator created in the tenant and your certificate configured in the application. Your client certificate must be in the cert:\CurrentUser\My section in the Windows certificates registry on the system you are running on. Once the authentication token is acquired, the script passes the token to an API call against a Sharepoint REST method. The script then outputs a JSON document that contains the Sharepoint tenant configuration settings received from the REST API.

### Example usage:
This example assumes you have a M365 tenant with the domain your365tenant.onmicrosoft.com

`.\SharepointAPIWithCertificate.ps1 -ClientId ac391fde-1ff0-222f-be3d-03d9ba6cb987 -CertificateThumbprint 93fd41a761f434f12ee8ac3ff771347597435696 -TenantDomainPrefix your365tenant`

## SampleSharepointTenantConfig.json
This is a sample Sharepoint tenant configuration settings output file generated by the script above.
